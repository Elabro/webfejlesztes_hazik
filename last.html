<!doctype html>
<html lang="hu">

  <head>
		<meta charset="utf-8">
	<title>Last.fm</title>
	
	<link rel="stylesheet" href="stylesheets/qunit.css" type="text/css" media="screen" />
	
</head>
<body>
	<h1 id="qunit-header">Last.fm</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<form>
		<input id="artist" type="text">
		<button type="submit" id="search">Search</button>
	</form>
	<div id="container">
		
	</div>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/processing.js/1.3.6/processing-api.min.js"></script>
	<link class="jsbin" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />
	<script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
	<script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.5/jquery-ui.js"></script>


	<script type="text/javascript" src="javascripts/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="javascripts/lodash.min.js"></script>
	<script type="text/javascript" src="javascripts/last.js"></script>
	<script type="text/javascript">

	var container = document.getElementById('container');
	var input = $('#artist');
	var auto = 3;
	
	function resetContainer() {
		container.innerHTML = '';
	}
	function showArtists( data ) {
	var availableTags = [];		
        $.each(data.results.artistmatches.artist, function(key, val) {
       
        	availableTags.push(val.name);
       	});  


		$( "#artist" ).autocomplete({
		source: availableTags
		});

	}
	
	
	function showArtists2( data ) {		
        $.each(data.results.artistmatches.artist, function(key, val) {
        var p = document.createElement('p');
        $(p).append('<a href="artist.html?artistname='+ val.name +'">'+val.name + '</a><br />');
        container.appendChild(p);
       	});  
	}
	$('#artist').keyup(function(){
	  if($(this).val().length > auto.val()-1){
		resetContainer();
	Last.getList( input.val(), showArtists ); }
	});
	
	$('#search').click(function(ev){
		ev.preventDefault();
		resetContainer();
		Last.getList( input.val(), showArtists2 );
	});

	</script>
</body>
</html>
